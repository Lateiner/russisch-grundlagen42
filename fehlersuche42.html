<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Russisch: Fehlersuche</title>
    <style>
        :root {
            --primary: #d32f2f; /* Rot als Basisfarbe für "Fehler" */
            --primary-dark: #b71c1c;
            --correct: #2e7d32; /* Grün für Korrektur */
            --accent: #ff4081;
            --bg: #f9f9f9;
            --card-bg: #ffffff;
            --text: #333;
            --neutral-btn: #e0e0e0;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0;
            padding: 0;
            padding-bottom: 100px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        .container {
            width: 100%;
            max-width: 700px;
            background: var(--card-bg);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            box-shadow: 0 0 20px rgba(0,0,0,0.05);
        }

        @media (min-width: 600px) {
            .container {
                min-height: auto;
                margin: 30px;
                border-radius: 16px;
                overflow: hidden;
            }
        }

        /* --- HEADER --- */
        .header {
            background: #333;
            color: white;
            padding: 20px;
            text-align: center;
        }

        h1 { margin: 0; font-size: 1.5rem; }
        .instructions {
            font-size: 0.95rem;
            margin-top: 10px;
            opacity: 0.9;
        }

        .progress-bar {
            height: 6px;
            background: #555;
            margin-top: 15px;
            border-radius: 3px;
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            background: var(--accent);
            width: 0%;
            transition: width 0.3s ease;
        }

        /* --- TASK AREA --- */
        .game-area {
            padding: 25px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 25px;
            flex-grow: 1;
        }

        /* Der Kontext (Deutsch) */
        .context-box {
            background: #f0f0f0;
            padding: 10px 15px;
            border-radius: 8px;
            color: #555;
            font-style: italic;
            text-align: center;
            width: 100%;
        }

        /* Der Satz mit dem Fehler */
        .sentence-box {
            font-size: 1.6rem;
            font-weight: 500;
            text-align: center;
            line-height: 1.6;
            margin: 10px 0;
        }

        /* Das fehlerhafte Wort (interaktiv) */
        .error-word {
            display: inline-block;
            padding: 2px 8px;
            border-bottom: 3px solid var(--primary);
            color: var(--primary);
            cursor: help;
            transition: all 0.3s ease;
            position: relative;
        }
        
        /* Das korrigierte Wort */
        .error-word.fixed {
            color: var(--correct);
            border-bottom-color: var(--correct);
            transform: scale(1.1);
        }

        /* Animation beim Wechsel */
        @keyframes swapText {
            0% { opacity: 0; transform: translateY(10px); }
            100% { opacity: 1; transform: translateY(0); }
        }

        .fade-in-text {
            animation: swapText 0.3s forwards;
        }

        /* Feedback Nachricht */
        .feedback {
            min-height: 1.5em;
            font-weight: bold;
            text-align: center;
        }

        /* --- OPTIONS (Corrections) --- */
        .options-container {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
            width: 100%;
            margin-top: 10px;
        }

        .option-btn {
            background: white;
            border: 2px solid #ccc;
            padding: 12px 20px;
            border-radius: 25px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.2s;
            color: var(--text);
            min-width: 120px;
            text-align: center;
            font-weight: 500;
        }

        .option-btn:hover:not(:disabled) {
            border-color: #333;
            background: #f5f5f5;
        }

        .option-btn:active:not(:disabled) {
            transform: scale(0.95);
        }

        /* States */
        .option-btn.correct {
            background: var(--correct);
            color: white;
            border-color: var(--correct);
            box-shadow: 0 4px 10px rgba(46, 125, 50, 0.3);
        }

        .option-btn.wrong {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
            opacity: 0.6;
        }

        .option-btn:disabled {
            cursor: default;
        }

        /* --- FOOTER CONTROLS --- */
        .footer-controls {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(5px);
            border-top: 1px solid #ccc;
            padding: 15px;
            display: flex;
            justify-content: center;
            gap: 15px;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
            z-index: 200;
        }

        button.ctrl-btn {
            padding: 12px 25px;
            border: none;
            border-radius: 25px;
            font-weight: bold;
            cursor: pointer;
            color: white;
            font-size: 1rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .btn-reset { background-color: #78909c; }
        .btn-solve { background-color: #546e7a; }
        .btn-next { background-color: var(--accent); display: none; }

        @media (max-width: 600px) {
            .sentence-box { font-size: 1.3rem; }
            .option-btn { width: 100%; }
        }

    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h1>Fehlersuche</h1>
        <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>
        <div class="instructions">
            Das rot markierte Verb ist falsch. Wähle unten die korrekte Form aus.
        </div>
    </div>

    <div class="game-area">
        <!-- Kontext -->
        <div class="context-box" id="germanContext">
            Lade Satz...
        </div>

        <!-- Satz -->
        <div class="sentence-box" id="sentenceDisplay">
            <!-- Wird per JS gefüllt -->
        </div>

        <!-- Feedback -->
        <div class="feedback" id="feedbackMsg"></div>

        <!-- Optionen -->
        <div class="options-container" id="optionsPool">
            <!-- Buttons per JS -->
        </div>
    </div>
</div>

<div class="footer-controls">
    <button class="ctrl-btn btn-reset" onclick="initLevel()">Reset</button>
    <button class="ctrl-btn btn-solve" onclick="showSolution()">Lösung</button>
    <button class="ctrl-btn btn-next" id="nextBtn" onclick="nextLevel()">Weiter ➜</button>
</div>

<script>
    // --- DATEN ---
    // pre: Text vor dem Fehler
    // wrong: Das falsche Wort (wird angezeigt)
    // post: Text nach dem Fehler
    // correct: Die richtige Lösung
    // distractors: Falsche Auswahlmöglichkeiten
    // german: Bedeutung des Satzes
    const levels = [
        {
            german: "Ich habe den Vertrag unterschrieben (nicht abgeschrieben).",
            pre: "Я",
            wrong: "списал",
            post: "договор.",
            correct: "подписал",
            distractors: ["написал", "расписал"]
        },
        {
            german: "Der Arzt hat mir ein Rezept ausgestellt (nicht aufgeschrieben).",
            pre: "Врач",
            wrong: "записал",
            post: "мне рецепт.",
            correct: "выписал",
            distractors: ["вписал", "дописал"]
        },
        {
            german: "Der Künstler hat die Vase bemalt (nicht unterschrieben).",
            pre: "Художник",
            wrong: "подписал",
            post: "вазу.",
            correct: "расписал",
            distractors: ["списал", "описал"]
        },
        {
            german: "Ich habe mich vom Kurs abgemeldet (nicht angemeldet).",
            pre: "Я",
            wrong: "записался",
            post: "с курса, так как нет времени.",
            correct: "выписался",
            distractors: ["подписался", "написался"]
        },
        {
            german: "Der Student hat bei der Prüfung abgeschrieben (nicht unterschrieben).",
            pre: "Студент",
            wrong: "подписал",
            post: "на экзамене.",
            correct: "списал",
            distractors: ["расписал", "вписал"]
        },
        {
            german: "Hast du dich schon auf den Kanal abonniert (nicht gemalt)?",
            pre: "Ты уже",
            wrong: "расписался",
            post: "на канал?",
            correct: "подписался",
            distractors: ["списался", "описался"]
        },
        {
            german: "Tragen Sie hier das Wort ein (nicht schreiben Sie heraus).",
            pre: "Пожалуйста,",
            wrong: "выпишите",
            post: "здесь слово.",
            correct: "впишите",
            distractors: ["спишите", "надпишите"]
        },
        {
            german: "Beschreiben Sie den Täter (nicht schreiben Sie ihn an).",
            pre: "",
            wrong: "Запишите",
            post: "преступника.",
            correct: "Опишите",
            distractors: ["Напишите", "Подпишите"]
        }
    ];

    let currentIdx = 0;
    let isSolved = false;

    // --- INIT ---
    function initGame() {
        currentIdx = 0;
        loadLevel(0);
    }

    function initLevel() {
        loadLevel(currentIdx);
    }

    // --- LEVEL LADEN ---
    function loadLevel(idx) {
        if (idx >= levels.length) {
            alert("Alle Fehler gefunden! Gute Arbeit.");
            currentIdx = 0;
            idx = 0;
        }

        const data = levels[idx];
        isSolved = false;

        // UI Reset
        document.getElementById('germanContext').textContent = data.german;
        document.getElementById('feedbackMsg').textContent = '';
        document.getElementById('nextBtn').style.display = 'none';

        // Progress
        const pct = (idx / levels.length) * 100;
        document.getElementById('progressFill').style.width = `${pct}%`;

        // Satz bauen
        const sentenceContainer = document.getElementById('sentenceDisplay');
        sentenceContainer.innerHTML = `
            ${data.pre} 
            <span class="error-word" id="targetWord">${data.wrong}</span> 
            ${data.post}
        `;

        // Optionen erstellen
        const pool = document.getElementById('optionsPool');
        pool.innerHTML = '';

        const allOptions = [data.correct, ...data.distractors];
        // Mischen
        allOptions.sort(() => 0.5 - Math.random());

        allOptions.forEach(opt => {
            const btn = document.createElement('button');
            btn.className = 'option-btn';
            btn.textContent = opt;
            btn.onclick = () => checkAnswer(opt, btn);
            pool.appendChild(btn);
        });
    }

    // --- CHECK ---
    function checkAnswer(selectedWord, btnElement) {
        if (isSolved) return;

        const data = levels[currentIdx];
        const targetWordSpan = document.getElementById('targetWord');

        if (selectedWord === data.correct) {
            // Richtig
            isSolved = true;
            
            // Visuelles Feedback am Button
            btnElement.classList.add('correct');
            
            // Visuelles Feedback im Satz (Wort austauschen mit Animation)
            targetWordSpan.classList.add('fixed');
            targetWordSpan.classList.add('fade-in-text');
            targetWordSpan.textContent = selectedWord; // Text ersetzen

            document.getElementById('feedbackMsg').textContent = "Korrekt!";
            document.getElementById('feedbackMsg').style.color = "var(--correct)";
            
            document.getElementById('nextBtn').style.display = 'block';

            // Andere Buttons deaktivieren
            const allBtns = document.querySelectorAll('.option-btn');
            allBtns.forEach(b => b.disabled = true);

        } else {
            // Falsch
            btnElement.classList.add('wrong');
            btnElement.disabled = true; // Button deaktivieren

            document.getElementById('feedbackMsg').textContent = "Das passt nicht.";
            document.getElementById('feedbackMsg').style.color = "var(--primary)";
        }
    }

    // --- CONTROLS ---
    function showSolution() {
        if (isSolved) return;
        
        const data = levels[currentIdx];
        
        // Suche den richtigen Button
        const allBtns = document.querySelectorAll('.option-btn');
        let correctBtn = null;
        allBtns.forEach(b => {
            if (b.textContent === data.correct) correctBtn = b;
        });

        if (correctBtn) {
            checkAnswer(data.correct, correctBtn);
            document.getElementById('feedbackMsg').textContent = "Lösung angezeigt.";
        }
    }

    function nextLevel() {
        currentIdx++;
        loadLevel(currentIdx);
    }

    // Start
    window.onload = initGame;

</script>

</body>
</html>